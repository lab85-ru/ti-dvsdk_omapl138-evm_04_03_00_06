/*
 *  Load platform file for evm6748
 */
utils.loadPlatform("ti.platforms.evm6748");

/*
 * Enable common BIOS features used by all examples
 */
bios.enableRealTimeAnalysis(prog);
bios.enableMemoryHeaps(prog);
bios.enableRtdx(prog);
bios.enableTskManager(prog);

/* Enable ECM Handler */
bios.ECM.ENABLE = 1;

/*
 * Enable heap usage.
 * Note: Heap Size is so large due to VPSS test application
 */
bios.MEM.instance("DDR").createHeap = 1;
bios.MEM.instance("DDR").heapSize = 0x01000000;

bios.LOG.instance("LOG_system").bufLen = 1024;
bios.LOG.instance("LOG_system").bufSeg = prog.get("IRAM");

bios.LOG_system.bufLen = 1024;
bios.LOG_system.logType = "circular";

bios.LOG.create("trace");
bios.LOG.instance("trace").bufLen = 1024;
bios.LOG.instance("trace").bufSeg = prog.get("IRAM");

bios.LOG.create("DVTEvent_Log");
bios.LOG.instance("DVTEvent_Log").bufSeg = prog.get("IRAM");
bios.LOG.instance("DVTEvent_Log").bufLen = 8192;
bios.LOG.instance("DVTEvent_Log").comment = "DVT";

/*Decide on sections*/
bios.SIO.OBJMEMSEG = prog.get("DDR");
bios.DIO.OBJMEMSEG = prog.get("DDR");
bios.SEM.OBJMEMSEG = prog.get("DDR");
bios.MBX.OBJMEMSEG = prog.get("DDR");
bios.QUE.OBJMEMSEG = prog.get("DDR");
bios.LCK.OBJMEMSEG = prog.get("DDR");
bios.SWI.OBJMEMSEG = prog.get("DDR");
bios.TSK.OBJMEMSEG = prog.get("DDR");
bios.TSK.STACKSEG = prog.get("DDR");
bios.PRD.OBJMEMSEG = prog.get("DDR");
bios.MEM.BIOSOBJSEG = prog.get("DDR");
bios.MEM.MALLOCSEG = prog.get("DDR");
bios.MEM.ARGSSEG = prog.get("DDR");
bios.MEM.STACKSEG = prog.get("DDR");
bios.MEM.GBLINITSEG = prog.get("DDR");
bios.MEM.TRCDATASEG = prog.get("DDR");
bios.MEM.OBJSEG = prog.get("DDR");
bios.MEM.SYSDATASEG = prog.get("DDR");
bios.MEM.TEXTSEG = prog.get("DDR");
bios.MEM.SWITCHSEG = prog.get("DDR");
bios.MEM.BSSSEG = prog.get("DDR");
bios.MEM.CINITSEG = prog.get("DDR");
bios.MEM.FARSEG = prog.get("DDR");
bios.MEM.PINITSEG = prog.get("DDR");
bios.MEM.CONSTSEG = prog.get("DDR");
bios.MEM.DATASEG = prog.get("DDR");
bios.MEM.CIOSEG = prog.get("DDR");
bios.MEM.BIOSSEG = prog.get("DDR");
bios.MEM.SYSINITSEG = prog.get("DDR");
bios.MEM.HWISEG = prog.get("DDR");
bios.MEM.HWIVECSEG = prog.get("DDR");
bios.MEM.RTDXTEXTSEG = prog.get("DDR");

bios.MEM.MALLOCSEG = prog.get("DDR");
bios.BUF.OBJMEMSEG = prog.get("DDR");
bios.LOG.OBJMEMSEG = prog.get("DDR");
bios.STS.OBJMEMSEG = prog.get("DDR");
bios.IDL.OBJMEMSEG = prog.get("DDR");
bios.DHL.OBJMEMSEG = prog.get("DDR");
bios.RTDX.RTDXDATASEG = prog.get("DDR");
bios.TSK.instance("TSK_idle").stackMemSeg = prog.get("DDR");
bios.LOG.instance("LOG_system").bufSeg = prog.get("DDR");
bios.HST.OBJMEMSEG = prog.get("DDR");
bios.HST.instance("RTA_fromHost").bufSeg = prog.get("DDR");
bios.HST.instance("RTA_toHost").bufSeg = prog.get("DDR");
bios.SYS.TRACESEG = prog.get("DDR");
bios.PIP.OBJMEMSEG = prog.get("DDR");
bios.CLK.OBJMEMSEG = prog.get("DDR");
bios.CLK.RESETTIMER = 1;

/*ECM configuration*/
bios.HWI.instance("HWI_INT7").interruptSelectNumber = 0;
bios.HWI.instance("HWI_INT8").interruptSelectNumber = 1;
bios.HWI.instance("HWI_INT9").interruptSelectNumber = 2;
bios.HWI.instance("HWI_INT10").interruptSelectNumber = 3;

bios.TSK.instance("TSK_idle").order = 1;

/*task configuration*/
bios.TSK.create("echoTask");
bios.TSK.instance("echoTask").stackSize = 32768;
bios.TSK.instance("echoTask").fxn = prog.extern("echo");
bios.TSK.instance("echoTask").comment = "Echo Task";
bios.TSK.instance("TSK_idle").order = 1;
bios.TSK.instance("echoTask").order = 2;

/* DDR size is 128MB, Heap is 48MB, Stack is 32K */
bios.MEM.STACKSIZE = 0x8000;
bios.MEM.instance("DDR").len = 0x08000000;
bios.MEM.instance("IRAM").base = 0x11810000;
// !GRAPHICAL_CONFIG_TOOL_SCRIPT_INSERT_POINT!

prog.gen();

