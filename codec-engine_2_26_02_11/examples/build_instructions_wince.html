<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- --COPYRIGHT--,BSD
 *  Copyright (c) 2010, Texas Instruments Incorporated
 *  All rights reserved.
 *
 *  Redistribution and use in source and binary forms, with or without
 *  modification, are permitted provided that the following conditions
 *  are met:
 *
 *  *  Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 *
 *  *  Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in the
 *     documentation and/or other materials provided with the distribution.
 *
 *  *  Neither the name of Texas Instruments Incorporated nor the names of
 *     its contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 *  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 *  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 *  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 *  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 *  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 *  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
 *  OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
 *  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 *  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * --/COPYRIGHT--
-->
<html>
<head>
  <title>Codec Engine Example Build Instructions for Windows CE</title>
<!-- For now, we use the doxygen style sheet -->
  <link type="text/css" rel="stylesheet" href="../docs/html/doxygen.css">
</head>
<body>
<table width="100%">
  <tbody>
    <tr>
      <td bgcolor="black" width="1">
        <a href="http://www.ti.com">
          <img src="../docs/html/tilogo.gif" border="0" alt="Texas
	  Instruments">
        </a>
      </td>
      <td bgcolor="red">
        <img src="../docs/html/titagline.gif" alt="Technology for
	Innovators">
      </td>
    </tr>
  </tbody>
</table>
<h1>Build/Run Instructions for Codec Engine Examples for Windows CE</h1>
<hr>
<h2>General Information</h2>
<p>This page explains how to build the examples provided in the
Codec Engine (CE) product for Windows CE.
</p>
<p>Examples currently contain the simple pass-through (copy) codecs,
implemented in the XDM algorithm standard.
</p>
<p>More details are available at the
  <a href="http://tiexpressdsp.com/index.php?title=Codec_Engine_Examples">
   Codec Engine Examples Overview</a> wiki article.
</p>
<hr>
<h2>Requirements</h2>
<p>See the release notes for the specific software and hardware components this
release of Codec Engine has been validated against.
</p>
<hr>
<h2>Directory Structure</h2>
<p>This section describes the layout under the examples directory.  In
most cases, these examples are XDC packages, and there are links to
the autogenerated XDC documentation.  In some cases, the
examples are not proper XDC packages, and documentation is provided
in other means (see the specific example's directory).
</p>
<pre>
examples
    +---apps
    |   `---system_files        <span style="color: rgb(0, 164, 0);">Linux scripts describing which .ko's are required and how to load them for different platforms</span>
    |       +---DM355
    |       |---DM357
    |       |---DM6446
    |       |---DM6467
    |       |---OMAP2530
    |       `---OMAP3530
    `---ti
        `---sdo
            `---ce
                `---examples    <span style="color: rgb(0, 164, 0);">Buildable example codecs, DSP servers, and ARM and/or DSP apps</span>
                    +---codecs
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/auddec1_copy/package.html">auddec1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/auddec1_ires/package.html">auddec1_ires</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/auddec_copy/package.html">auddec_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/audenc1_copy/package.html">audenc1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/audenc_copy/package.html">audenc_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/g711/package.html">g711</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/imgdec1_copy/package.html">imgdec1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/imgdec_copy/package.html">imgdec_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/imgenc1_copy/package.html">imgenc1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/imgenc_copy/package.html">imgenc_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/scale/package.html">scale</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/sphdec1_copy/package.html">sphdec1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/sphdec_copy/package.html">sphdec_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/sphenc1_copy/package.html">sphenc1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/sphenc_copy/package.html">sphenc_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/universal_copy/package.html">universalcopy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/vidanalytics_copy/package.html">vidanalytics_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/viddec1_copy/package.html">viddec1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/viddec2_copy/package.html">viddec2_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/viddec2split_copy/package.html">viddec2split_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/viddec_copy/package.html">viddec_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/videnc1_copy/package.html">videnc1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/videnc_copy/package.html">videnc_copy</a>
                    |   `---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/vidtranscode_copy/package.html">vidtranscode_copy</a>
                    |
                    +---extensions
                    |   `---<a href="../xdoc/index.html#ti/sdo/ce/examples/extensions/scale/package.html">scale</a>
                    |
                    +---servers
                    |   `---<a href="../xdoc/index.html#ti/sdo/ce/examples/servers/all_codecs/package.html">all_codecs</a>
                    |
                    `---apps
                        +---audio1_copy
                        |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/audio1_copy/async/package.html">async</a>
                        |   `---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/audio1_copy/sync/package.html">sync</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/audio1_ires/package.html">audio1_ires</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/audio_copy/package.html">audio_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/image1_copy/package.html">image1_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/image_copy/package.html">image_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/scale/package.html">scale</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/server_api_example/package.html">server_api_example</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/server_trace/package.html">server_trace</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/speech/package.html">speech</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/speech1_copy/package.html">speech1_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/speech_copy/package.html">speech_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/speech_copy_LAD/package.html">speech_copy_LAD</a>   <span style="color: rgb(128, 128, 128);">Not validated on WinCE</span>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/universal_copy/package.html">universal_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/vidanalytics/package.html">vidanalytics</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/video1_copy/package.html">video1_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/video2_copy/package.html">video2_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/video2split_copy/package.html">video2split_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/video_copy/package.html">video_copy</a>
                        `---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/vidtranscode/package.html">vidtranscode</a>
</pre>

<hr>
<h2>Configuring WindowsCE BSP Files for Codec Engine</h2>
<p><i>Important</i>: throughout this document, we will use the
following notation:
</p>
<ul>
  <li><tt>%_WINCEROOT%</tt> - Directory where Windows CE is installed,
  e.g. <tt>C:\WINCE600</tt></li>
  <li><tt>&lt;BSP_FOLDER&gt;</tt> - The name of the BSP, e.g. TI_EVM_3530.
  <li><tt>%_FLATRELEASEDIR%</tt> - The directory containing the built Windows CE image
  for the target platform, e.g.<br><tt>C:\WINCE600\OSDesigns\TI_EVM_3530\RelDir\TI_EVM_3530_ARMV4I_Release.</tt></li>
</ul>
<p>
You will need to integrate DSPLink, CMEM, and LPM into your Platform Builder
environment. For DSPLink integration, follow the instructions in the DSPLink
Install Guide for WinCE.
</p>
<p>
<span style="color: rgb(255, 0, 0);">
Important Note: It is possible that pre-built dsplink and cmem binaries are
provided by the BSP. Make sure that the inclusion of these binaries is
disabled. Check for pre-built cmem binaries in %_WINCEROOT%\PLATFORM\&lt;BSP&gt;\Files folder. These binaries should either be deleted or renamed.
</span>
</p>
You can manually add the CMEM and LPM configurations to the platform.reg and platform.bib files.
You can also integrate CMEM by adding it to your Platform Builder subprojects.<br>
<br>
For integrating CMEM and LPM outside of Platform Builder, use the instructions in
the following section. For Platform Builder integration of CMEM, see the next section.
</p>

<h3>1. Manual integration of CMEM and LPM</h3>
<p>
The CMEM dlls are located either in WinCE Utils or under cetools, depending on
your Codec Engine distribution.  We will refer to this location as
WINCEUTILS_INSTALL_DIR.  Similarly, the LPM driver may also be under its
own installation, or under cetools.  We will refer to its location as LPM_INSTALL_DIR.
Copy the prebuilt cmemk.dll from<br>
<br>
<tt>&nbsp;&nbsp;&nbsp;WINCEUTILS_INSTALL_DIR\packages\ti\sdo\winceutils\cmem\drivers\<span style="color: rgb(255, 0, 0);">OMAP3530</span>\obj\ARMV4I\<span style="color: rgb(255, 0, 0);">retail</span></tt><br>
<br>
(or <span style="color:rgb(255, 0, 0);">Davinci</span>) to the
<tt>%_WINCEROOT%\PLATFORM\&lt;BSP&gt;\Files</tt> folder.
</p>
<p>
Copy the <tt>lpmdrv.dll</tt> and <tt>lpmdrv.pdb</tt> files
for your board from<br>
<br>
<tt>LPM_INSTALL_DIR\packages\ti\bios\power\drivers\wince\omap3530\lpm\obj\ARMV4I\retail</tt><br>
<br>
to the <tt>%_WINCEROOT%\PLATFORM\&lt;BSP&gt;\Files</tt> folder.
</p>
<p>
Add the following lines to the platform.bib file in
<tt>%_WINCEROOT%\PLATFORM\&lt;BSP_FOLDER&gt;\FILES</tt>.<br>
<br>
<tt><span style="color: rgb(0, 0, 255);">
;-- CMEM --------------------------------------------------------------------</span><br>
IF SYSGEN_CMEM<br>
&nbsp;&nbsp;&nbsp;&nbsp;cmemk.dll &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(_FLATRELEASEDIR)\cmemk.dll&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NK SHK<br>
ENDIF SYSGEN_CMEM<br>
<span style="color: rgb(0, 0, 255);">
;----------------------------------------------------------------------------</span><br>
<br>
<span style="color: rgb(0, 0, 255);">
;-- LPM ---------------------------------------------------------------------</span><br>
IF SYSGEN_LPM<br>
&nbsp;&nbsp;&nbsp;&nbsp;lpmdrv.dll&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(_FLATRELEASEDIR)\lpmdrv.dll&nbsp;&nbsp;&nbsp;&nbsp;NK SHK<br>
ENDIF SYSGEN_LPM<br>
<span style="color: rgb(0, 0, 255);">
;----------------------------------------------------------------------------</span><br>
</tt>
</p>
<p>Make sure to define the environment variables, <tt>SYSGEN_CMEM</tt> and
<tt>SYSGEN_LPM</tt>, by setting them in you project properties.
</p>
Add the CMEM and LPM registry data to the
<tt>%_WINCEROOT%\PLATFORM\&lt;BSP_FOLDER&gt;\FILES\platform.reg</tt> file.
<p>The following registry
entry for OMAP3530 can be copied to the platform.reg, or used as an example
to create your own CMEM configuration. If you change the CMEM address range
in the registry, you may also need to change the DSP server's memory map to
ensure that the CMEM address range does not overlap with the DSP memory
segments. (The DSP server memory map is defined in a tconf configuration
file. For example, the codec engine all_codecs server for OMAP3530 has its
memory map in examples/servers/all_codecs/all_evm3530.tci).
<br><tt>
<br><span style="color: rgb(0, 0, 255);">
;-- CMEM --------------------------------------------------------------------</span>
<br>IF SYSGEN_CMEM
<br>[HKEY_LOCAL_MACHINE\Drivers\BuiltIn\CMEMK]
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Prefix"</span>=<span style="color: rgb(192, 92, 92);">"CMK"</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Dll"</span>=<span style="color: rgb(192, 92, 92);">"cmemk.dll"</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Index"</span>=dword:1
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(0, 0, 255);">; Make 7 pools available for allocation for block 0
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
; Make 0 pools available for allocation for block 1</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"NumPools0"</span>=dword:7
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"NumPools1"</span>=dword:0
<br>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_NumBuffers_Pool0"</span>=dword:20
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_PoolSize_Pool0"</span>=dword:1000 <span style="color: rgb(0, 0, 255);">; size in bytes (hex)</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_NumBuffers_Pool1"</span>=dword:8
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_PoolSize_Pool1"</span>=dword:20000 <span style="color: rgb(0, 0, 255);">; size in bytes (hex)</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_NumBuffers_Pool2"</span>=dword:5
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_PoolSize_Pool2"</span>=dword:100000 <span style="color: rgb(0, 0, 255);">; size in bytes (hex)</span>
<br>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_NumBuffers_Pool3"</span>=dword:1
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_PoolSize_Pool3"</span>=dword:15cfc0 <span style="color: rgb(0, 0, 255);">; size in bytes (hex)</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_NumBuffers_Pool4"</span>=dword:1
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_PoolSize_Pool4"</span>=dword:3e800 <span style="color: rgb(0, 0, 255);">; size in bytes (hex)</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_NumBuffers_Pool5"</span>=dword:1
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_PoolSize_Pool5"</span>=dword:36ee80 <span style="color: rgb(0, 0, 255);">; size in bytes (hex)</span>
<br>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_NumBuffers_Pool6"</span>=dword:3
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_PoolSize_Pool6"</span>=dword:96000 <span style="color: rgb(0, 0, 255);">; size in bytes (hex)</span>
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(0, 0, 255);">
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ;; "Block1_NumBuffers_Pool1"=dword:2
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ;; "Block1_PoolSize_Pool1"=dword:4000 <span style="color: rgb(0, 0, 255);">; size in bytes (hex)</span>
<br></span>
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(0, 0, 255);">
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; Physical start + physical end can be use to ask CMEM to map a specific range of physical addresses.
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; This is a potential security risk.  If physical start == 0 then the code hits a special case.
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; physical end - physical start == length of allocation.  In the special case, memory is allocated
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; via a call to AllocPhysMem() (as shown in this example).  MmMapIoSpace() is used to map the normal
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; case where physical start != 0.
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; physical start and end for block 0</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(192, 92, 92);">"PhysicalStart0"</span>=dword:85000000
<br>    &nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(192, 92,
92);">"PhysicalEnd0"</span>=dword:86000000
<br>
<br>    &nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 255);">; physical start and end for block 1</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(192, 92, 92);">"PhysicalStart1"</span>=dword:0
<br>    &nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(192, 92, 92);">"PhysicalEnd1"</span>=dword:0
<br>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(0, 0, 255);">; Set UseHeapIfPoolUnavailable to
non-zero to allow allocations
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; in CMEM heap if allocation from CMEM pools fails.</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"UseHeapIfPoolUnavailable"</span>=dword:0
<br>ENDIF SYSGEN_CMEM
<br><span style="color: rgb(0, 0, 255);">
;----------------------------------------------------------------------------</span>
</tt></p>
<p>
Here is an example CMEM configuration for DM6446:
<br><tt>
<br><span style="color: rgb(0, 0, 255);">
;-- CMEM --------------------------------------------------------------------</span>
<br>IF SYSGEN_CMEM
<br>[HKEY_LOCAL_MACHINE\Drivers\BuiltIn\CMEMK]
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Prefix"</span>=<span style="color: rgb(192, 92, 92);">"CMK"</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Dll"</span>=<span style="color: rgb(192, 92, 92);">"cmemk.dll"</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Index"</span>=dword:1
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(0, 0, 255);">; Make 3 pools available for allocation for block 0</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(0, 0, 255);">; Make 0 pool available for allocation for block 1</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"NumPools0"</span>=dword:3
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"NumPools1"</span>=dword:0
<br>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_NumBuffers_Pool0"</span>=dword:20
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_PoolSize_Pool0"</span>=dword:1000 <span style="color: rgb(0, 0, 255);">; size in bytes (hex)</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_NumBuffers_Pool1"</span>=dword:8
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_PoolSize_Pool1"</span>=dword:20000 <span style="color: rgb(0, 0, 255);">; size in bytes (hex)</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_NumBuffers_Pool2"</span>=dword:2
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Block0_PoolSize_Pool2"</span>=dword:100000 <span style="color: rgb(0, 0, 255);">; size in bytes (hex)</span>
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(0, 0, 255);">
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; Physical start + physical end can be use to ask CMEM to map a specific range of physical addresses.
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; This is a potential security risk.  If physical start == 0 then the code hits a special case.
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; physical end - physical start == length of allocation.  In the special case, memory is allocated
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; via a call to AllocPhysMem() (as shown in this example).  MmMapIoSpace() is used to map the normal
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; case where physical start != 0.
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; physical start and end for block 0</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"PhysicalStart0"</span>=dword:87800000
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"PhysicalEnd0"</span>=dword:88000000
<br>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(0, 0, 255);">; physical start and end for block 1</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"PhysicalStart1"</span>=dword:0
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"PhysicalEnd1"</span>=dword:0
<br>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(0, 0, 255);">; Set UseHeapIfPoolUnavailable to
non-zero to allow allocations
<br>    &nbsp;&nbsp;&nbsp;&nbsp; ; in CMEM heap if allocation from CMEM pools fails.</span>
<br>    &nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"UseHeapIfPoolUnavailable"</span>=dword:0
<br>ENDIF SYSGEN_CMEM
<br><span style="color: rgb(0, 0, 255);">
;----------------------------------------------------------------------------</span>
</tt>
</p>
<p>
NOTE: Make sure that any reserved memory for CMEM specified in your
<tt>%_WINCEROOT%\PLATFORM\&lt;BSP_FOLDER&gt;\FILES\config.bib</tt>,
matches the addresses in platform.reg. For example, below is the MEMORY
section of a config.bib for OMAP3530, reserving a chunk of memory for CMEM starting at 0x85800000 (the
physical address 0x80000000 is mapped to the virtual address 0x84000000, so
subtract 0x400000 from 0x89800000 to get 0x85800000):
<br><br>
<tt>
<br>MEMORY
<br>&nbsp;&nbsp;&nbsp;&nbsp; ARGS &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 84000000 00001000 RESERVED ; 4K 
<br>IF SYSGEN_DSPLINK
<br>&nbsp;&nbsp;&nbsp;&nbsp; NK   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 84001000 01FFF000 RAMIMAGE ; 32MB - 4K
<br>&nbsp;&nbsp;&nbsp;&nbsp; RAM  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 86000000 02800000 RAM &nbsp;&nbsp;&nbsp;&nbsp; ; 40 MB
<br>&nbsp;&nbsp;&nbsp;&nbsp; DISPLAY  &nbsp;&nbsp;&nbsp; 88800000 01000000 RESERVED ; 16MB
<br>&nbsp;&nbsp;&nbsp;&nbsp; CMEM_DSP &nbsp;&nbsp; 89800000 02800000 RESERVED ; 40 MB
<br>ELSE
<br>&nbsp;&nbsp;&nbsp;&nbsp; NK &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 84001000 02FFF000 RAMIMAGE ; 48MB - 4K
<br>&nbsp;&nbsp;&nbsp;&nbsp; RAM  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 87000000 04000000 RAM &nbsp;&nbsp;&nbsp;&nbsp; ; 64MB
<br>&nbsp;&nbsp;&nbsp;&nbsp; DISPLAY  &nbsp;&nbsp;&nbsp; 8B000000 01000000 RESERVED ; 16MB
<br>ENDIF     
</tt>

</p>
<p>
If we set the start address of CMEM block0 to 0x85000000 in platform.reg, we
should modify the config.bib. In the example config.bib above, the memory
reserved for DISPLAY would overlap with the CMEM block in platform.reg. The
following shows the MEMORY section modified for the CMEM block0 starting at
0x85000000, along with memory reserved for other codec engine and dsplink
memory blocks (changed values are displayed in <span style="color: rgb(255, 0, 0);">red</span>, added entries are
displayed in <span style="color: rgb(0, 0, 255);">blue</span>):

<br><br>
<tt>
<br>MEMORY
<br>&nbsp;&nbsp;&nbsp;&nbsp; ARGS &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 84000000 00001000 RESERVED ; 4K 
<br>IF SYSGEN_DSPLINK
<br>&nbsp;&nbsp;&nbsp;&nbsp; NK   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 84001000 01FFF000 RAMIMAGE ; 32MB - 4K
<br>&nbsp;&nbsp;&nbsp;&nbsp; RAM  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 86000000 <span style="color: rgb(255, 0, 0);">02000000</span> RAM &nbsp;&nbsp;&nbsp;&nbsp; ; 40 MB
<br>&nbsp;&nbsp;&nbsp;&nbsp; DISPLAY  &nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 0, 0);">88000000</span> 01000000 RESERVED ; 16MB
<br>&nbsp;&nbsp;&nbsp;&nbsp; CMEM_DSP &nbsp;&nbsp; <span style="color: rgb(255, 0, 0);">89000000 01000000</span> RESERVED ; 40 MB
<br>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(0, 0, 255);">DDRALGHEAP&nbsp; 8A000000    01800000    RESERVED ; 24 MB
<br>&nbsp;&nbsp;&nbsp;&nbsp; DDR2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8B800000    00600000    RESERVED ;
<br>&nbsp;&nbsp;&nbsp;&nbsp; DSPLINKMEM&nbsp; 8BE00000    00100000    RESERVED ;
<br>&nbsp;&nbsp;&nbsp;&nbsp; RESETCTRL&nbsp;&nbsp; 8BF00000    00001000
RESERVED ; </span>
<br>ELSE
<br>&nbsp;&nbsp;&nbsp;&nbsp; NK &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 84001000 02FFF000 RAMIMAGE ; 48MB - 4K
<br>&nbsp;&nbsp;&nbsp;&nbsp; RAM  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 87000000 04000000 RAM &nbsp;&nbsp;&nbsp;&nbsp; ; 64MB
<br>&nbsp;&nbsp;&nbsp;&nbsp; DISPLAY  &nbsp;&nbsp;&nbsp; 8B000000 01000000 RESERVED ; 16MB
<br>ENDIF     
</tt>
</p>
<p>
Add the following LPM registry key to the <tt>platform.reg</tt> file:<br>
<br>
<tt><span style="color: rgb(0, 0, 255);">
;-- LPM ------------------------------------------------------------------</span><br>
IF SYSGEN_LPM<br>
[HKEY_LOCAL_MACHINE\Drivers\BuiltIn\LPM]<br>
&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Prefix"</span>=<span style="color: rgb(192, 92, 92);">"LPM"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Dll"</span>=<span style="color: rgb(192, 92, 92);">"lpmdrv.dll"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Index"</span>=dword:1<br>
&nbsp;&nbsp;&nbsp;&nbsp;
<span style="color: rgb(192, 92, 92);">"Trace"</span>=dword:0<br>
ENDIF SYSGEN_LPM<br>
<span style="color: rgb(0, 0, 255);">
;-----------------------------------------------------------------------------</span></tt><br>
<br>
Note: the debug trace messages are only supported by the debug build of
the driver. To enable driver trace messages, copy the driver files from
the debug folder and set the following registry value:<br>
<br>
<tt>HKEY_LOCAL_MACHINE\Drivers\BuiltIn\LPM\Trace = 1</tt><br>
</p>
<p>
Since the platform.bib and platform.reg files have been modified, you will
need to rebuil the BSP.
</p>

<h3>2. Platform Builder IDE integration of CMEM</h3>
<p>
Follow these steps to integrate the CMEM build into your Platform Builder project.
</p>
<ul>
  <li>Copy the CMEM catalog, cmem.pbcxml, file from
WINCEUTILS_INSTALL_DIR\packages\ti\sdo\winceutils\cmem\catalog to
<tt>%_WINCEROOT\PLATFORM\&lt;BSP&gt;\CATALOG</tt>. In Platform Builder, refresh the
Catalog View to see the CMEM catalog item.</li>
<li>In the Visual Studio Solution Explorer, add the cmem project to your
solution's subprojects by right clicking on the "Subprojects" and selecting
"Add Existing Subproject?" from the pop-up menu. Browse to the
WINCEUTILS_INSTALL_DIR\ti\sdo\winceutils\cmem\drivers\cmem.pbpxml file.</li>

  <li>Edit the ti\sdo\winceutils\cmem\drivers\OMAP353\SOURCES (or Davinci) file and change the line:
<br><tt>&nbsp;&nbsp;RELEASETYPE=LOCAL</tt>
<br>
to
<br><tt>&nbsp;&nbsp;RELEASETYPE=<span style="color: rgb(255, 0, 0);">PLATFORM</span></tt>
</li>
<li>Rebuild the BSP and subprojects. (In the Platform Builder Build menu,
select "Advanced Build Commands" -&gt; "Build Current BSP and Subprojects".)</li>
</ul>
<hr>

<h2>Building the examples: step-by-step instructions</h2>
<p><i>Important</i>: throughout the rest of this document, we will use the
following notation:
</p>
<ul>
  <li><tt>&lt;CE_EXAMPLES_INSTALL_DIR&gt;</tt> - absolute path of the
  examples directory or the copy you made,
  e.g. <tt>C:/work/examples</tt></li>
  <li><tt>&lt;CE_INSTALL_DIR&gt;</tt> - root directory of your Codec Engine
  installation. The original examples are in
  <tt>&lt;CE_INSTALL_DIR&gt;/examples</tt>.</li>
  <li><tt>&lt;BIOS_INSTALL_DIR&gt;</tt> - root directory of your DSP/BIOS
  installation.</li>
  <li><tt>&lt;XDC_INSTALL_DIR&gt;</tt> - root directory of your xdctools
  installation.</li>
  <li><i>directory/file</i> - position of the file relative to the
  examples directory; for examples, <tt>ti/sdo/ce/examples/codecs/makefile</tt> refers to
  <tt>&lt;CE_EXAMPLES_INSTALL_DIR&gt;ti/sdo/ce/examples/codecs/makefile</tt>.</li>
</ul>

<h3>1. Rebuild DSPLink for use with Codec Engine Remote Apps</h3>
<p>
Codec Engine no longer comes with a pre-built version of DSPLink in the
cetools directory. You will need to get the DSPLink product and build it.
Follow the instructions in the Install Guide for DSP/BIOS Link for the
platform you are using, to install and build DSPLink. The configuration of
DSPLink for use with Codec Engine may be slightly different than that
described in the DSP/BIOS Link install guide. For example, to configure
DSPLink on OMAP3530, run the following commands:
<br><br><tt>&nbsp;&nbsp;&nbsp;cd &lt;DSPLINK_INSTALL_DIR&gt;\dsplink\etc\host\scripts\msdos</tt>
<br><tt>&nbsp;&nbsp;&nbsp;dsplinkenv.bat</tt>
<br><tt>&nbsp;&nbsp;&nbsp;dsplinkcfg.bat --platform=OMAP3530 --nodsp=1 --dspcfg_0=OMAP3530SHMEM --dspos_0=DSPBIOS5XX --gppos=WINCE --comps=poslm</tt>
</p>
<p>To configure
DSPLink on DM6446, run the following commands:
<br><br><tt>&nbsp;&nbsp;&nbsp;cd &lt;DSPLINK_INSTALL_DIR&gt;\dsplink\etc\host\scripts\msdos</tt>
<br><tt>&nbsp;&nbsp;&nbsp;dsplinkenv.bat</tt>
<br><tt>&nbsp;&nbsp;&nbsp;dsplinkcfg.bat --platform=DAVINCI --nodsp=1 --dspcfg_0=DM6446GEMSHMEM --dspos_0=DSPBIOS5XX --gppos=WINCE --comps=poslm</tt>
</p>
<p>
The dsplinkk.dll will be present in the
<tt>%_WINCEROOT%\PLATFORM\&ltBSP_FOLDER&gt\target\ARMV4\retail</tt>. You will
need to copy it to the <tt>%_FLATRELEASEDIR%</tt>

<h3>2. Copy the CMEM driver to the <tt>%_FLATRELEASEDIR%</tt> directory</h3>
<p>
Copy the <tt>cmemk.dll</tt> file for your board from the <tt>WINCEUTILS_INSTALL_DIR</tt>
directory to the <tt>%_FLATRELEASEDIR%</tt> directory. For example,
if you are using OMAP3530, copy the file from<br>
<br>
<tt>WINCEUTILS_INSTALL_DIR\packages\ti\sdo\winceutils\cmem\src\module\OMAP3530\obj\ARMV4I\retail</tt><br>
<br>
Note: You may also want to copy the file into the<br>
<br>
<tt>%_WINCEROOT%\PLATFORM\&lt;BSP_FOLDER&gt;\FILES</tt><br>
<br>
directory, since doing a clean build of the BSP will wipe out
the release directory.
</p>

<h3>3. Copy the LPM driver to the <tt>%_FLATRELEASEDIR%</tt> directory</h3>
<p>
Copy the <tt>lpmdrv.dll</tt> and <tt><b>lpmdrv.pdb</b></tt> files for your board
from the <tt>$(LPM_INSTLL_DIR)</tt> directory to the <tt>%_FLATRELEASEDIR%</tt> directory.
For example, if you are using OMAP3530, copy the files from<br>
<br>
<tt>LPM_INSTALL_DIR\packages\ti\bios\power\drivers\wince\omap3530\lpm\obj\ARMV4I\retail</tt><br>
<br>
Note: You may also want to copy these files into the<br>
<br>
<tt>%_WINCEROOT%\PLATFORM\&lt;BSP_FOLDER&gt;\FILES</tt><br>
<br>
directory, since doing a clean build of the BSP will wipe out
the release directory.
</p>

<h3>4. Rebuild the BSP</h3>
<p>
Since new files have been added to the <tt>%_FLATRELEASEDIR%</tt> directory,
you will need to rebuild the BSP. Select the following menu command from
Visual Studio<br>
<br>
Build &gt; Make Run-Time Image
</p>

<h3>5. [Optional] Copy the entire "examples" tree out of the product</h3>
<p>
This step is optional, but recommended if you plan to modify the
samples in any way. It will ensure you have a backup copy of the
original examples, as provided by the Codec Engine product.
</p>

<h3>6. Edit xdcpaths.mak to customize the build for your
software installation and your hardware</h3>
<p>
At the root of the Examples directory is a build-related file named
<b>xdcpaths.mak</b> that all Codec Engine example makefiles include.
Almost all users must edit this file to specify where various software
components needed by Codec Engine are on their system, and often to
narrow the list of hardware platforms to build for (thereby reducing
the example build time and possibly the scope of external components).
</p>
<p>
The variables defined in <b>xdcpaths.mak</b> that most users must
assign are:  <tt>DEVICES</tt>, <tt>GPPOS</tt>, <tt>PROGRAMS</tt>, and
various <tt>*_INSTALL_DIR</tt> variables.  Each are described more
below as well as in comments throughout the <b>xdcpaths.mak</b> file.
</p>
<p>
Advanced users will note that these GNU make-based variables can be
overridden on the command line.  As a result, it is possible to tailor
these makefiles without modifying them - by simply setting the variables
on the command line when running "gmake".
</p>

<h4>6.1 xdcpaths.mak's DEVICES variable</h4>
<p>
The <tt>DEVICES</tt> variable indicates which hardware platforms should be
built for.  Most users are only interested in building for a single
platform, and the other platforms can be removed from the <tt>DEVICES</tt>
variable.
</p>
<p>
Note that there is a one-to-one mapping between the "short name" in the
<tt>DEVICES</tt> macro and the "platform package" which is used.  For
example, the <tt>OMAP3530</tt> value in <tt>DEVICES</tt> maps to the
<tt>ti.platforms.evm3530</tt> platform package.
</p>

<h4>6.2 xdcpaths.mak's GPPOS variable</h4>
<p>
The <tt>GPPOS</tt> variable indicates which GPP (General Purpose Processor,
often an ARM) OS's should be built for.  Most users are only interested in
building for a single GPP OS (e.g. WinCE or Linux glibc or Linux uClibc),
and the other GPP OS's can be removed from the <tt>GPPOS</tt> variable.
<p>
Note that there is a one-to-one mapping between the "short name" in the
<tt>GPPOS</tt> macro and the "target module" which is used.  For
example, the <tt>WINCE</tt> value in <tt>GPPOS</tt> maps to the
<tt>microsoft.targets.arm.WinCE</tt> target Module.
</p>

<h4>6.3 xdcpaths.mak's PROGRAMS variable</h4>
<p>
The <tt>PROGRAMS</tt> variable indicates roughly which system architecture
the examples should be built for.  Generally, Codec Engine supports "local"
and "remote" codecs, and as a result there are 3 types of executables that
can be built - <tt>APP_LOCAL</tt>, <tt>APP_CLIENT</tt> and
<tt>DSP_SERVER</tt>.</p>
<p>
<tt>APP_LOCAL</tt> indicates that all examples that support the apps and
codecs running on the same processor should be built.  This is typically
set for single core devices (e.g. DM365, DM6437), but can als be set for
multi-core devices (e.g. OMAP3530, DM6446) where the app and codec run on
either the GPP or the DSP.
</p>
<p>
<tt>APP_CLIENT</tt> and <tt>DSP_SERVER</tt> typically go together, and
indicate that all examples that support remote execution of codecs should
be built.  If <tt>DSP_SERVER</tt> is set in the <tt>PROGRAMS</tt> variable
and an appropriate multi-core platform is set in the <tt>DEVICES</tt>
variable, the examples in <b>examples/ti/sdo/ce/examples/servers</b> may be
built.  <tt>APP_CLIENT</tt> indicates the "client" side of a "client/server"
system, so GPP-side apps will be built (for the appropriate GPP OS's and
hardware platforms set in <tt>GPPOS</tt> and <tt>DEVICES</tt> respectively).
<p>
Note that you can set all 3 (<tt>APP_LOCAL</tt>, <tt>APP_CLIENT</tt>, and
<tt>DSP_SERVER</tt>) or any subset of them.  As a further example, if only
<tt>DSP_SERVER</tt> is set, no applications will be built, but all
components required to create a server (including codecs) will be built.
</p>
<h4>6.4 xdcpaths.mak's various *_INSTALL_DIR, CGTOOLS_* and CC_* variables</h4>
<p>
The <b>xdcpaths.mak</b> file also contains variables to indicate where
products which Codec Engine may depend on are installed.  The list of
dependent products is a direct result of what values are assigned in the
<tt>DEVICES</tt>, <tt>GPPOS</tt> and <tt>PROGRAMS</tt> variables.  For
example, if you've set <tt>PROGRAMS</tt> to only <tt>APP_LOCAL</tt>,
<tt>DEVICES</tt> to only <tt>DM355</tt>, and <tt>GPP_OS</tt> to
<tt>LINUX_UCLIBC</tt>, you aren't required to provide
<tt>DSPLINK_INSTALL_DIR</tt>, <tt>BIOS_INSTALL_DIR</tt>,
<tt>CGTOOLS_V5T</tt> or <tt>CC_V5T</tt>
</p>
<p>Make sure you set the variables <tt><b>WINCE_ROOTDIR</b></tt> and
<tt><b>WINCE_PROJECTROOT</b></tt> correctly.
<p>
Further, if you're using a "full" installation of Codec Engine (see
<a href="http://tiexpressdsp.com/index.php?title=Codec_Engine_FAQ#Why_do_some_distributions_have_a_cetools_directory_and_others_don.27t.3F">
http://tiexpressdsp.com/index.php?title=Codec_Engine_FAQ#Why_do_some_distributions_have_a_cetools_directory_and_others_don.27t.3F</a>
for more details), many of the dependencies will be "auto-assigned" for you
to the <b>cetools/packages</b> directory.
</p>
<p>
Please refer to the comments throughout <b>xdcpaths.mak</b> for more
details.
</p>

<p>
Each directory contains a GNU <tt>makefile</tt> which enables you to build
the sample in the current directory.  Top-level directories also
contain a <tt>makefile</tt> which steps into subdirectories and builds
all the examples under the parent directory.
<p>FYI, the xdcpaths.mak file is included by the individual makefiles
for all the example codecs, servers, and applications.</p>
<p>Please keep in mind that <b><span style="color: rgb(153, 0, 0);">MOST
BUILD TROUBLES OCCUR WHEN ONE OF THE VARIOUS <tt>*_INSTALL_DIR</tt>
VARIABLES ARE INCORRECT!</span></b>
Make sure there are no extra spaces (check the end of lines!), that every
individual path (segment separated by the semicolon) is correct, character
for character, and the build process is very likely to go smoothly.
</p>

<h3>7. Build example codecs</h3>
<p>Open a command window and change directory to <b>ti\sdo\ce\examples\codecs</b> and type</p>
<p>&nbsp;&nbsp;&nbsp; <b>gmake clean<br>
&nbsp;&nbsp;&nbsp; gmake</b></p>

<p>Alternatively, you can change into a specific codec's directory
(e.g. <b>ti\sdo\ce\examples\codecs\viddec_copy</b>), and type</p>
<p>&nbsp;&nbsp;&nbsp; <b>gmake clean<br>
&nbsp;&nbsp;&nbsp; gmake</b></p>


<h3>8. Build example extensions</h3>
<p>Change directory to <b>ti\sdo\ce\examples\extensions</b> and type</p>
<p>&nbsp;&nbsp;&nbsp; <b>gmake clean<br>
&nbsp;&nbsp;&nbsp; gmake</b></p>

<p>Alternatively, you can change into a specific example extension directory
(e.g. <b>ti\sdo\ce\examples\extensions\scale</b>), and type</p>
<p>&nbsp;&nbsp;&nbsp; <b>gmake clean<br>
&nbsp;&nbsp;&nbsp; gmake</b></p>


<h3>9. Build example DSP servers</h3>
<p>Note that this is only necessary for dual processor environments,
like DM6446.</p>
<p>Change directory to <tt>ti\sdo\ce\examples\servers</tt> and type</p>
<p>&nbsp;&nbsp;&nbsp; <b>gmake clean<br>
&nbsp;&nbsp;&nbsp; gmake<br>
</b></p>
<p>Alternatively, you can change into a specific server's directory
(e.g. <tt>ti\sdo\ce\examples\servers\video_copy</tt>), and type</p>
<p>&nbsp;&nbsp;&nbsp; <b>gmake clean<br>
&nbsp;&nbsp;&nbsp; gmake<br>
</b></p>
<p>Note: when developing your own codecs and applications, you will
likely take one of the DSP server sample and modify it to suit your
needs.
These are the source files for this server application that you need to
know about:
</p>
<ul>
  <li>*.cfg:  Configuration script that determines what codecs
should be included in the server, and how some of the components
(e.g. DSKT2 and DMAN3) will be configured.</li>
  <li>*.tcf:  TConf file for the app.  It is often set to allow for a
generous heap and static code and data.  Be very
careful with changing the memory map.</li>
  <li>main.c: generic main()</li>
  <li>link.cmd: application specific linker command file.</li>
</ul>

<h3>10. Build the GPP applications</h3>
<p>Change directory to <tt>ti\sdo\ce\examples\apps</tt>
(where the makefile is) and type</p>
<p>&nbsp;&nbsp;&nbsp; <b>gmake clean<br>
&nbsp;&nbsp;&nbsp; gmake</b>
</p>

<h3>11. Copy files to the target and run</h3>
<p>For a given application you want to run, you need to copy that application's
executable to the target, and if your application requires a DSP server, you
need to copy that DSP server to the target as well. (You can see which DSP
server -- a DSP binary with .x64P or .x674 extension -- is required by the
application if you look at the application's .cfg file.) In addition, you
should copy the input data file "in.dat" to the target, keeping the relative
position between the application executable and the in.dat file.
</p>

<p>
Note, you can copy the DSP Server to the target by using the "Windows CE
Remote File Viewer" (see Example 1).  The Windows CE app and "in.dat" can
be copied to the %_FLATRELEASEDIR%, and run with the
"Windows CE Command Prompt" (see Example 1).
</p>

<p>
Also, you must make sure that all the required kernel modules (.dll's) for
your target are built into the target image.
</p>

<p>
<b>Example 1:</b> Running the image1_copy example on evm3530:<br>
The ARM-side of the image1_copy example for evm3530 is in the directory
<tt>examples\ti\sdo\ce\examples\apps\image1_copy\bin\ti_platforms_evm3530</tt>. Copy the
<b>app_remote_wince.exe</b> file to the %_FLATRELEASEDIR%, along with <b>in.dat</b> -- which is in the
image1_copy directory.
<br><br>The <b>remote.cfg</b> file in that directory lists "all.x64P" as its
DSP server image, so you must copy the <b>all.x64P</b> DSP executable for
evm3530 from <tt>examples\ti\sdo\ce\examples\servers</tt> (more precisely
from
<tt>examples\ti\sdo\ce\examples\servers\all_codecs\bin\ti_platforms_evm3530\</tt>)
to the target. To copy <b>all.x64P</b> to the target, in Visual Studio, open the "Windows CE
Remote File Viewer", by selecting "File Viewer" from the <b>Target->Remote
Tools</b> menu. In the Remote File Viewer, select the <b>File->Export File</b>
menu option, and browse to the server (eg, all.x64P) to download to the
target.
<br><br>Copy the image1_copy apps to %_FLATRELEASEDIR%. Since various
codec engine examples have the same name, it may be more convenient to just copy
the apps directory to %_FLATRELEASEDIR%. To run the image1_copy example,
open the "Windows CE command prompt" by selecting the <b>Target->Target Control</b>
menu item in Visual Studio. For the local Windows CE app, in the command
prompt type the following command (all one line):
<br><br><tt><span style="color: rgb(153, 0, 153);">s apps\image1_copy\bin\ti_platforms_evm3530\app_local_wince.exe "Release\\apps\\image1_copy\\in.dat" "Release\\apps\\image1_copy\\local.out.dat"</span></tt>
<br><br>To run the remote Windows CE app, type the following command:
<br><br><tt><span style="color: rgb(153, 0, 153);">s apps\image1_copy\bin\ti_platforms_evm3530\app_remote_wince.exe "Release\\apps\\image1_copy\\in.dat" "Release\\apps\\image1_copy\\remote.out.dat"</span></tt>
</p>

<hr>
<h2>Memory map</h2>
For information on the default DM6446 memory map -- as addressed by the kernel module
loading scripts and DSP/BIOS configuration files (.tcf scripts) -- and
instructions on how to change this map, please refer to
<a href="http://tiexpressdsp.com/index.php?title=Changing_the_DVEVM_memory_map">
http://tiexpressdsp.com/index.php?title=Changing_the_DVEVM_memory_map</a>


<hr>
<p>
Last updated: December 2, 2010
</p>
</body>
</html>
